const cartModel=require("../models/cart.model"),validationResult=require("../models/checkValue");exports.getCart=(req,res,next)=>{cartModel.getItemsByUser(req.session.userId).then(items=>{res.render("cart",{items:items,isUser:!0})}).catch(err=>{console.log(err)})},exports.postCart=(req,res,next)=>{let r=validationResult.checkVal({v:[req.body.amount,{notEmpty:{msg:"amount is requires"},min:{min:1,msg:"amount must be grater then 0"}}]});0===r.length?cartModel.addNewItem({name:req.body.name,price:req.body.price,amount:req.body.amount,productId:req.body.productId,userId:req.session.userId,timestamp:Date.now()}).then(()=>{res.redirect("/cart")}).catch(err=>{console.log(err)}):(req.flash("validationError",r),res.redirect(req.body.redirectTo))};